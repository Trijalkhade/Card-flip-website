<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>ClubHoloHub — Login</title>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <style>
    body { 
      font-family: Inter, system-ui, sans-serif; 
      display:flex; flex-direction:column; 
      align-items:center; justify-content:center; 
      min-height:100vh; margin:0; 
      background: linear-gradient(135deg,#0f172a,#0b1220); 
      color:#e6eef8; 
    }

    form { 
      background: rgba(255,255,255,0.06); 
      padding:24px; border-radius:12px; 
      display:flex; flex-direction:column; 
      width:280px; 
      box-shadow:0 8px 24px rgba(0,0,0,0.4); 
    }

    input { 
      margin:8px 0; padding:10px; border-radius:8px; border:none; 
    }

    input.error {
      border: 2px solid #f87171; /* red border */
      background-color: rgba(248, 113, 113, 0.1); /* light red bg */
    }

    .error-message {
      color: #f87171;
      font-size: 0.85rem;
      margin-top: 4px;
      display: none;
    }

    .success-message {
      color: #22c55e; /* green */
      font-size: 0.9rem;
      margin-top: 8px;
      text-align: center;
      display: none;
    }

    button { 
      margin-top:12px; padding:10px; border-radius:8px; 
      border:none; cursor:pointer; background:#10b981; 
      color:white; font-weight:bold; 
    }

    a { margin-top:10px; color:#6ee7b7; text-decoration:none; text-align:center; }
  </style>
</head>
<body>
  <form id="loginForm">
    <h2>Login</h2>

    <input id="loginUsername" placeholder="Username" required/>
    <div id="usernameError" class="error-message">Invalid username</div>

    <input id="loginPassword" type="password" placeholder="Password" required/>
    <div id="passwordError" class="error-message">Invalid password</div>

    <button type="submit">Login</button>

    <div id="generalError" class="error-message">Something went wrong. Please try again.</div>
    <div id="successMessage" class="success-message"></div>

    <a href="signup.html">Don’t have an account? Signup</a>
  </form>

<script>
document.getElementById("loginForm").addEventListener("submit", async (e) => {
  e.preventDefault();

  const usernameInput = document.getElementById("loginUsername");
  const passwordInput = document.getElementById("loginPassword");

  const usernameError = document.getElementById("usernameError");
  const passwordError = document.getElementById("passwordError");
  const generalError = document.getElementById("generalError");
  const successMessage = document.getElementById("successMessage");

  // Reset previous messages
  usernameInput.classList.remove("error");
  passwordInput.classList.remove("error");
  usernameError.style.display = "none";
  passwordError.style.display = "none";
  generalError.style.display = "none";
  successMessage.style.display = "none";

  const username = usernameInput.value;
  const password = passwordInput.value;

  try {
    const res = await fetch("http://localhost:8000/login", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ username, password })
    });

    const data = await res.json();

    if (!res.ok) {
      if (data.detail && data.detail.includes("invalid credentials")) {
        // Show red error below username field
        usernameInput.classList.add("error");
        passwordInput.classList.add("error");
        usernameError.textContent = "Invalid username or password";
        usernameError.style.display = "block";
        passwordError.style.display = "none"; // only one message
        usernameInput.focus();
      } else {
        generalError.textContent = data.detail || "Login failed";
        generalError.style.display = "block";
      }
      return;
    }

    // Successful login: show green message
    successMessage.textContent = "Welcome " + data.username + "!";
    successMessage.style.display = "block";

    // Optional: redirect after 1.5 seconds
    setTimeout(() => {
      window.location.href = "index.html";
    }, 1500);

  } catch (err) {
    console.error(err);
    generalError.textContent = "Login error: " + err.message;
    generalError.style.display = "block";
  }
});
</script>
</body>
</html>

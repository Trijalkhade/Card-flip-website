<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <title>ClubHoloHub â€” Signup</title>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <style>
    body { 
      font-family: Inter, system-ui, sans-serif; 
      display:flex; flex-direction:column; 
      align-items:center; justify-content:center; 
      min-height:100vh; margin:0; 
      background: linear-gradient(135deg,#0f172a,#0b1220); 
      color:#e6eef8; 
    }

    form { 
      background: rgba(255,255,255,0.06); 
      padding:24px; border-radius:12px; 
      display:flex; flex-direction:column; 
      width:280px; 
      box-shadow:0 8px 24px rgba(0,0,0,0.4); 
    }

    input { 
      margin:8px 0; padding:10px; border-radius:8px; border:none; 
    }

    input.error {
      border: 2px solid #f87171; /* red border */
      background-color: rgba(248, 113, 113, 0.1); /* light red bg */
    }

    .error-message {
      color: #f87171;
      font-size: 0.85rem;
      margin-top: 4px;
      display: none;
    }

    button { 
      margin-top:12px; padding:10px; border-radius:8px; 
      border:none; cursor:pointer; background:#3b82f6; 
      color:white; font-weight:bold; 
    }

    a { margin-top:10px; color:#93c5fd; text-decoration:none; text-align:center; }
  </style>
</head>
<body>
  <form id="signupForm">
    <h2>Signup</h2>

    <input id="signupUsername" placeholder="Username" required/>
    <div id="usernameError" class="error-message">Username already exists</div>

    <input id="signupPassword" type="password" placeholder="Password" required/>
    <div id="passwordError" class="error-message">Invalid password</div>

    <input id="signupFullName" placeholder="Full Name" required/>

    <button type="submit">Signup</button>
    <div id="generalError" class="error-message">Something went wrong. Please try again.</div>
    <a href="login.html">Already have an account? Login</a>
  </form>

<script>
document.getElementById("signupForm").addEventListener("submit", async (e) => {
  e.preventDefault();

  // Elements
  const usernameInput = document.getElementById("signupUsername");
  const passwordInput = document.getElementById("signupPassword");
  const fullNameInput = document.getElementById("signupFullName");

  const usernameError = document.getElementById("usernameError");
  const passwordError = document.getElementById("passwordError");
  const generalError = document.getElementById("generalError");

  // Reset previous errors
  usernameInput.classList.remove("error");
  passwordInput.classList.remove("error");
  usernameError.style.display = "none";
  passwordError.style.display = "none";
  generalError.style.display = "none";

  const username = usernameInput.value;
  const password = passwordInput.value;
  const full_name = fullNameInput.value;

  try {
    const res = await fetch("http://localhost:8000/signup", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ username, password, full_name })
    });

    const data = await res.json();

    if (!res.ok) {
      // Inline error handling like Amazon
      if (data.detail && data.detail.includes("username already exists")) {
        usernameInput.classList.add("error");
        usernameError.style.display = "block";
        usernameInput.focus();
      } else if (data.detail && data.detail.includes("password")) {
        passwordInput.classList.add("error");
        passwordError.textContent = data.detail;
        passwordError.style.display = "block";
        passwordInput.focus();
      } else {
        generalError.style.display = "block";
      }
      return;
    }

    // Success
    alert("Signup successful! You can now login as " + data.username);
    window.location.href = "login.html";

  } catch (err) {
    console.error(err);
    generalError.textContent = "Signup error: " + err.message;
    generalError.style.display = "block";
  }
});
</script>
</body>
</html>
